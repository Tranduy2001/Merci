"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4982],{71444:function(e,n){let t=(e,n)=>{let{width:t,height:l}=n,i=t/l,r=t,s=l;return i>e?r=l*e:i<e&&(s=t/e),{width:r,height:s}};n.Z=t},86981:function(e,n,t){t.d(n,{Z:function(){return l}});function l(e,n,t,l){let i=Math.max(Math.min(l,(t-1)/2),0),r=e-i,s=r<0?t+r:r,o=(e+i)%t;return s<o&&n>=s&&n<=o||s>=o&&(n>=s||n<=o)}},34982:function(e,n,t){t.d(n,{I:function(){return X}});var l=t(388),i=t(24246),r=t(27378),s=t(5148),o=t(46413),a=t(54374),c=t(80503),d=t(84174),u=t(17572),x=t(60675),h=t(71051),f=t(41080),g=t(28048),p=t(77278),m=t(29173),j=t(45372),y=t(72352),v=t(774),b=t(2912),w=t(7025),k=t(73871),C=t(10043),D=t(60597),S=t(87228),_=t(27114),A=t(34412),E=t.n(A),R=t(79894),z=t.n(R),I=t(54837);t(29676);var O=t(66230),M=t(30158),Z=t(38541),F=t(56552),W=t(86677),T=t.n(W),B=t(86144),H=t(7872),L=t(71444),N=t(8408),q=t(73868),P=t(52853),G=t(81645),U=t(21765);let V=(0,r.forwardRef)(function(e,n){let{currentlyVisible:t,truncatedTemplate:l,imageId:s,containerSize:o,shouldRender:a,onVisible:c,refetch:d,contextMenuElements:x,onContextMenuActionComplete:h,styles:f,...g}=e,p=(0,r.useRef)(null),{data:m}=(0,q.useSession)(),{templateEditorStore:j}=(0,N.oR)(),y=(0,P.s$)(),v=(0,U.Z)(),{isLoading:b,data:k}=(0,F.useQuery)(["template",l.id,s],async()=>{var e;let n=Z.Z.stringify({"image-id":s},{skipNull:!0}),{data:t,status:i,apiErrors:r}=await y((0,B.nO)().get("/api/templates/".concat(l.id,"?").concat(n)),{skipErrorHandling:e=>{var n,t,l;return(null===(n=e.response)||void 0===n?void 0:n.status)===404||(null===(t=null===(l=e.response)||void 0===l?void 0:l.data.errors[0])||void 0===t?void 0:t.code)==="IMAGE_ID_ERROR"}});if(404===i)T().replace("/404");else{if(!r||(null===(e=r[0])||void 0===e?void 0:e.code)!=="IMAGE_ID_ERROR")return null==t?void 0:t.data.template;T().replace("/design-not-found")}},{refetchOnMount:d}),C=(0,L.Z)(l.aspectRatio,{width:o.width,height:Math.max(o.height-60,0)});function D(e,n){h&&h(e,n)}return(0,r.useEffect)(()=>{k&&t&&c(k)},[k,t,c]),(0,r.useImperativeHandle)(n,()=>({async download(e){var n,t,l;let{analyticsEvent:i}=e,r=!!(null==m?void 0:null===(n=m.user)||void 0===n?void 0:null===(t=n.subscriptions)||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.active);return await v({analyticsEvent:i,template:k,hasSubscription:r,templateEditorStore:j,imageId:s,canvas:{konvaGroup:p.current,position:{x:0,y:0},size:C}}),null!=r&&r}})),a?(0,i.jsxs)(u.k,{flexDirection:"column",alignItems:"center",...f,children:[(0,i.jsx)(O.M2,{condition:!s&&!!x&&x.length>0,wrapper:e=>(0,i.jsx)(O.xV,{elements:null!=x?x:[],breakPoint:"lg",onActionComplete:D,children:e}),children:(0,i.jsx)(H.Z,{ref:p,loading:b,template:k,canvasSize:C,shouldRender:a,...g})}),(0,i.jsx)(w.x,{noOfLines:1,width:(0,G.Z)(C).width,textAlign:"center",color:"gray.500",fontSize:"sm",height:"".concat(60,"px"),pt:2,children:k&&k.name})]}):(0,i.jsx)(i.Fragment,{})});var K=t(86981);function Q(){let e=(0,l.Z)(["\n                .chakra-modal__content-container {\n                  justify-content: flex-end !important;\n                }\n              "]);return Q=function(){return e},e}function Y(){let e=(0,l.Z)(["\n              .carousel-root {\n                width: 100%;\n                flex-grow: 1;\n              }\n\n              .carousel,\n              .carousel .slider-wrapper,\n              .carousel .slider {\n                height: 100%;\n              }\n\n              .carousel .slide {\n                background: none;\n              }\n            "]);return Y=function(){return e},e}let $=(0,s.m)(o.z,{baseStyle:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",position:"absolute",top:{base:"-16px",lg:"-30px"},fontSize:{base:"24px",md:"48",lg:"60px"},zIndex:5,color:"gray.400"}}),J=e=>{let{category:n,currentTemplateId:t,imageId:l,hideNumberOfTemplates:s,onTemplateChange:A,onTemplateUpdate:R,onTemplateDelete:F}=e,{data:T}=(0,q.useSession)(),B=(0,W.useRouter)(),H=(0,a.p)(),L=(0,r.useRef)(),N=n.templates.findIndex(e=>e.id===t),[G,U]=(0,r.useState)(N>-1?N:0),[J,X]=(0,r.useState)(null),ee=(0,r.useRef)(n.templates.reduce((e,n)=>(e[n.id]=(0,r.createRef)(),e),{})),en="/templates/".concat(t,"/edit/").concat(l?"?iid=".concat(l):""),{ref:et,height:el=1,width:ei=1}=E()(),[er,es]=(0,r.useState)(!1),[eo,ea]=(0,r.useState)(!1),{isOpen:ec,onOpen:ed,onClose:eu}=(0,c.q)(),ex=(0,d.S)({base:!0,lg:!1}),eh=(0,r.useRef)(null),ef=(0,r.useRef)(null),eg=(0,r.useMemo)(()=>[P.oD.AUTOMATE,P.oD.DOWNLOAD],[]),ep=(0,P.qP)({template:null!=J?J:void 0,renameModalRef:eh,deleteModalRef:ef,mock:eg}),[em,ej]=(0,r.useState)(!0),ey=(0,r.useRef)(null),ev=(0,r.useRef)(!1);(0,r.useEffect)(()=>{B.query.saved&&!L.current&&(L.current=H({id:"toast-saved-template",position:"top",duration:6e3,render:()=>(0,i.jsx)(O.FN,{text:"Design successfully saved."})}),B.replace(Z.Z.exclude(B.asPath,["saved"]),void 0,{shallow:!0}))}),(0,r.useEffect)(()=>{!1!==ev.current&&(ev.current=!1,ej(!1),ey.current=G,U(-1),setTimeout(()=>{if(null===ey.current)return;let e=ey.current+1>=n.templates.length?n.templates.length-1:ey.current;U(e),A(n.templates[e].id),ej(!0)},0))},[n,G,A]);let eb=(0,r.useCallback)(()=>{L.current&&H.close(L.current)},[H]);function ew(){eb(),es(!0),(0,M.q)("automate_from_preview","website_automation")}function ek(e){X(e)}async function eC(){if(J){var e;null===(e=ee.current[J.id].current)||void 0===e||e.download({analyticsEvent:{name:"download_from_preview",category:"image"}}).then(e=>!e&&ea(!0))}}async function eD(e,n){eu();let t=await e.action(n);eS(e.type,t)}function eS(e,n){if(e===P.oD.AUTOMATE){ew();return}if(e===P.oD.DOWNLOAD){eC();return}n&&n.success&&(e===P.oD.RENAME&&J?R({...J,name:n.data}):e===P.oD.DELETE&&J&&(ev.current=!0,F(J.id)))}(0,r.useEffect)(()=>eb,[eb]);let e_=n.templates.length;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(u.k,{flexDir:"column",height:"100%",children:[!l&&J&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(O.tt,{ref:eh,template:J}),(0,i.jsx)(O.pf,{ref:ef,template:J})]}),!l&&ex&&ec&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(C.xB,{styles:(0,C.iv)(Q())}),(0,i.jsxs)(x.u_,{isOpen:ec,onClose:eu,size:"full",motionPreset:"none",children:[(0,i.jsx)(h.Z,{}),(0,i.jsxs)(f.h,{m:0,borderRadius:0,width:"auto",children:[(0,i.jsx)(g.x,{}),(0,i.jsx)(p.o,{size:"lg"}),(0,i.jsx)(m.f,{px:8,my:6,children:(0,i.jsx)(j.aV,{display:"flex",flexDir:"column",color:"gray.600",spacing:2,children:ep.map((e,n)=>(0,i.jsx)(j.HC,{children:(0,i.jsx)(o.z,{variant:"unstyled",display:"block",fontWeight:"normal",height:"auto",width:"100%",textAlign:"left",py:1,onClick:n=>eD(e,n),children:e.text})},n))})})]})]})]}),(0,i.jsxs)(y.W,{display:"flex",maxW:"container.lg",justifyContent:"space-between",alignItems:"center",pt:{base:4,lg:24},pb:6,px:4,children:[(0,i.jsx)(v.xu,{flex:"1 1 0px",children:(0,i.jsx)(z(),{passHref:!0,scroll:!1,href:l?"/gallery/?image-id=".concat(l):"/gallery/",legacyBehavior:!0,children:(0,i.jsxs)(b.r,{_hover:{textDecoration:"none"},variant:"unstyled",display:"flex",alignItems:"center",color:"gray.600",fontWeight:"700",children:[(0,i.jsx)(D.Ao2,{size:18}),(0,i.jsx)(w.x,{noOfLines:1,maxWidth:{base:140,lg:"unset"},ml:1.5,children:"All Designs"})]})})}),ex&&(0,i.jsx)(i.Fragment,{children:T&&!l&&ep.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.k,{flex:"1 1 0px",justifyContent:"center",children:(0,i.jsx)(z(),{href:"/",passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(b.r,{children:(0,i.jsx)(k.E,{alt:"Designify",height:{base:"28px",lg:"32px"},display:{base:"block",lg:"none"},src:"/logo_color.svg"})})})}),(0,i.jsx)(v.xu,{flex:"1 1 0px",textAlign:"right",children:(0,i.jsx)(o.z,{variant:"unstyled",onClick:ed,children:(0,i.jsx)(u.k,{p:3,gridGap:1,display:{base:"flex",lg:"none"},children:Array.from({length:3}).map((e,n)=>(0,i.jsx)(v.xu,{w:".25rem",height:".25rem",borderRadius:"50%",bgColor:"black"},n))})})})]}):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(z(),{href:"/",passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(b.r,{children:(0,i.jsx)(k.E,{alt:"Designify",height:{base:"28px",lg:"32px"},display:{base:"block",lg:"none"},src:"/designify_logo_color_dark.svg"})})})})})]}),(0,i.jsxs)(y.W,{ref:et,flex:"1",display:"flex",maxW:"container.lg",overflow:"hidden",justifyContent:"center",alignItems:"center",position:"relative",px:{base:4,md:12,lg:16},children:[(0,i.jsx)(C.xB,{styles:(0,C.iv)(Y())}),n.templates.length>1&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($,{variant:"unstyled",left:{base:"-12px",md:"-4px",lg:0},onClick:function(){U(G-1)},children:(0,i.jsx)(S.bUI,{})}),(0,i.jsx)($,{variant:"unstyled",right:{base:"-12px",md:"-4px",lg:0},onClick:function(){U(G+1)},children:(0,i.jsx)(S.Dli,{})})]}),(0,i.jsx)(v.xu,{display:"flex",flexDirection:"column",width:"100%",height:"100%",children:em&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.x,{noOfLines:1,textAlign:"center",color:"gray.500",fontSize:"sm",pb:2,children:"".concat(n.name).concat(s?"":" ".concat(G+1," of ").concat(n.templates.length))}),(0,i.jsx)(I.lr,{infiniteLoop:!0,autoPlay:!1,showStatus:!1,showIndicators:!1,showThumbs:!1,showArrows:!1,selectedItem:G,onChange:function(e){U(e),A(n.templates[e].id)},children:n.templates.map((e,t)=>{var r;return(0,K.Z)(G,t,e_,3)?(0,i.jsx)(V,{ref:ee.current[e.id],currentlyVisible:G===t,shouldRender:function(e,t){let l=n.templates.length;return t===e||t===(e-1<0?l-1:e-1)||t===(e+1>l-1?0:e+1)}(G,t),truncatedTemplate:e,imageId:l,containerSize:{width:ei,height:el-30},onVisible:ek,refetch:null!=T&&null!==(r=T.user)&&void 0!==r&&!!r.id&&T.user.id===e.userId,contextMenuElements:ep,onContextMenuActionComplete:eS,styles:{height:"100%",justifyContent:"center"}},e.id):(0,i.jsx)(v.xu,{},e.id)})})]})})]}),(0,i.jsxs)(u.k,{justifyContent:"center",pt:4,pb:{base:4,lg:6},children:[(0,i.jsx)(z(),{passHref:!0,href:en,legacyBehavior:!0,children:(0,i.jsxs)(b.r,{_hover:{textDecoration:"none"},textAlign:"center",display:"flex",flexDir:"column",justifyContent:"center",alignItems:"center",height:"auto",fontSize:"sm",width:{base:24,lg:32},color:"gray.900",fontWeight:"600",onClick:function(){(0,M.q)("edit_from_preview","editor",!1)},children:[(0,i.jsx)(_.dY,{color:"gray.900",flexShrink:0,fontSize:{base:"3rem",lg:"4rem"}}),"Edit"]})}),(0,i.jsxs)(o.z,{variant:"unstyled",textAlign:"center",display:"flex",flexDir:"column",justifyContent:"center",height:"auto",fontSize:"sm",width:{base:24,lg:32},mx:{base:8,lg:20},onClick:ew,children:[(0,i.jsx)(_.ZK,{color:"gray.900",flexShrink:0,fontSize:{base:"3rem",lg:"4rem"}}),"Start Batch"]}),(0,i.jsxs)(o.z,{variant:"unstyled",textAlign:"center",display:"flex",flexDir:"column",justifyContent:"center",height:"auto",fontSize:"sm",width:{base:24,lg:32},onClick:eC,children:[(0,i.jsx)(_.tx,{color:"palette.2",flexShrink:0,fontSize:{base:"3rem",lg:"4rem"}}),"Download"]})]})]}),J&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(O.rA,{template:J,open:er,onClose:function(){es(!1)}}),(0,i.jsx)(O.DI,{active:eo}),(0,i.jsx)(O._v,{open:eo,onClose:function(){ea(!1)},template:J,redirectUrl:"/pricing"})]})]})};var X=J}}]);